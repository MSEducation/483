<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Fri Apr 04 15:37:21 CEST 2025 -->
<title>Lucene90DocValuesFormat (Lucene 10.2.0 core API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-04-04">
<meta name="description" content="declaration: package: org.apache.lucene.codecs.lucene90, class: Lucene90DocValuesFormat">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Lucene90DocValuesFormat.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.lucene.codecs.lucene90</a></div>
<h1 title="Class Lucene90DocValuesFormat" class="title">Class Lucene90DocValuesFormat</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="../DocValuesFormat.html" title="class in org.apache.lucene.codecs">org.apache.lucene.codecs.DocValuesFormat</a>
<div class="inheritance">org.apache.lucene.codecs.lucene90.Lucene90DocValuesFormat</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../../util/NamedSPILoader.NamedSPI.html" title="interface in org.apache.lucene.util">NamedSPILoader.NamedSPI</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public final class </span><span class="element-name type-name-label">Lucene90DocValuesFormat</span>
<span class="extends-implements">extends <a href="../DocValuesFormat.html" title="class in org.apache.lucene.codecs">DocValuesFormat</a></span></div>
<div class="block">Lucene 9.0 DocValues format.

 <p>Documents that have a value for the field are encoded in a way that it is always possible to
 know the ordinal of the current document in the set of documents that have a value. For instance,
 say the set of documents that have a value for the field is <code>{1, 5, 6, 11}</code>. When the
 iterator is on <code>6</code>, it knows that this is the 3rd item of the set. This way, values
 can be stored densely and accessed based on their index at search time. If all documents in a
 segment have a value for the field, the index is the same as the doc ID, so this case is encoded
 implicitly and is very fast at query time. On the other hand if some documents are missing a
 value for the field then the set of documents that have a value is encoded into blocks. All doc
 IDs that share the same upper 16 bits are encoded into the same block with the following
 strategies:

 <ul>
   <li>SPARSE: This strategy is used when a block contains at most 4095 documents. The lower 16
       bits of doc IDs are stored as <a href="../../store/DataOutput.html#writeShort(short)"><code>shorts</code></a> while the upper
       16 bits are given by the block ID.
   <li>DENSE: This strategy is used when a block contains between 4096 and 65535 documents. The
       lower bits of doc IDs are stored in a bit set. Advancing &lt; 512 documents is performed
       using <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html#numberOfTrailingZeros-long-" title="class or interface in java.lang" class="external-link"><code>ntz</code></a> operations while the index is computed
       by accumulating the <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html#bitCount-long-" title="class or interface in java.lang" class="external-link"><code>bit counts</code></a> of the visited longs. Advancing
       &gt;= 512 documents is performed by skipping to the start of the needed 512 document
       sub-block and iterating to the specific document within that block. The index for the
       sub-block that is skipped to is retrieved from a rank-table positioned before the bit set.
       The rank-table holds the origo index numbers for all 512 documents sub-blocks, represented
       as an unsigned short for each 128 blocks.
   <li>ALL: This strategy is used when a block contains exactly 65536 documents, meaning that the
       block is full. In that case doc IDs do not need to be stored explicitly. This is typically
       faster than both SPARSE and DENSE which is a reason why it is preferable to have all
       documents that have a value for a field using contiguous doc IDs, for instance by using
       <a href="../../index/IndexWriterConfig.html#setIndexSort(org.apache.lucene.search.Sort)"><code>index sorting</code></a>.
 </ul>

 <p>Skipping blocks to arrive at a wanted document is either done on an iterative basis or by
 using the jump-table stored at the end of the chain of blocks. The jump-table holds the offset as
 well as the index for all blocks, packed in a single long per block.

 <p>Then the five per-document value types (Numeric,Binary,Sorted,SortedSet,SortedNumeric) are
 encoded using the following strategies:

 <p><a href="../../index/DocValuesType.html#NUMERIC"><code>NUMERIC</code></a>:

 <ul>
   <li>Delta-compressed: per-document integers written as deltas from the minimum value,
       compressed with bitpacking. For more information, see <a href="../../util/packed/DirectWriter.html" title="class in org.apache.lucene.util.packed"><code>DirectWriter</code></a>.
   <li>Table-compressed: when the number of unique values is very small (&lt; 256), and when there
       are unused "gaps" in the range of values used (such as <a href="../../util/SmallFloat.html" title="class in org.apache.lucene.util"><code>SmallFloat</code></a>), a lookup table
       is written instead. Each per-document entry is instead the ordinal to this table, and those
       ordinals are compressed with bitpacking (<a href="../../util/packed/DirectWriter.html" title="class in org.apache.lucene.util.packed"><code>DirectWriter</code></a>).
   <li>GCD-compressed: when all numbers share a common divisor, such as dates, the greatest common
       denominator (GCD) is computed, and quotients are stored using Delta-compressed Numerics.
   <li>Monotonic-compressed: when all numbers are monotonically increasing offsets, they are
       written as blocks of bitpacked integers, encoding the deviation from the expected delta.
   <li>Const-compressed: when there is only one possible value, no per-document data is needed and
       this value is encoded alone.
 </ul>

 <p>Depending on calculated gains, the numbers might be split into blocks of 16384 values. In that
 case, a jump-table with block offsets is appended to the blocks for O(1) access to the needed
 block.

 <p><a href="../../index/DocValuesType.html#BINARY"><code>BINARY</code></a>:

 <ul>
   <li>Fixed-width Binary: one large concatenated byte[] is written, along with the fixed length.
       Each document's value can be addressed directly with multiplication (<code>docID *
       length</code>).
   <li>Variable-width Binary: one large concatenated byte[] is written, along with end addresses
       for each document. The addresses are written as Monotonic-compressed numerics.
   <li>Prefix-compressed Binary: values are written in chunks of 16, with the first value written
       completely and other values sharing prefixes. chunk addresses are written as
       Monotonic-compressed numerics. A reverse lookup index is written from a portion of every
       1024th term.
 </ul>

 <p><a href="../../index/DocValuesType.html#SORTED"><code>SORTED</code></a>:

 <ul>
   <li>Sorted: a mapping of ordinals to deduplicated terms is written as Prefix-compressed Binary,
       along with the per-document ordinals written using one of the numeric strategies above.
 </ul>

 <p><a href="../../index/DocValuesType.html#SORTED_SET"><code>SORTED_SET</code></a>:

 <ul>
   <li>Single: if all documents have 0 or 1 value, then data are written like SORTED.
   <li>SortedSet: a mapping of ordinals to deduplicated terms is written as Binary, an ordinal
       list and per-document index into this list are written using the numeric strategies above.
 </ul>

 <p><a href="../../index/DocValuesType.html#SORTED_NUMERIC"><code>SORTED_NUMERIC</code></a>:

 <ul>
   <li>Single: if all documents have 0 or 1 value, then data are written like NUMERIC.
   <li>SortedNumeric: a value list and per-document index into this list are written using the
       numeric strategies above.
 </ul>

 <p>Files:

 <ol>
   <li><code>.dvd</code>: DocValues data
   <li><code>.dvm</code>: DocValues metadata
 </ol></div>
<dl class="notes">
<dt>WARNING: This API is experimental and might change in incompatible ways in the next release.</dt>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">Lucene90DocValuesFormat</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Default constructor.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(int)" class="member-name-link">Lucene90DocValuesFormat</a><wbr>(int&nbsp;skipIndexIntervalSize)</code></div>
<div class="col-last odd-row-color">
<div class="block">Doc values fields format with specified skipIndexIntervalSize.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../DocValuesConsumer.html" title="class in org.apache.lucene.codecs">DocValuesConsumer</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#fieldsConsumer(org.apache.lucene.index.SegmentWriteState)" class="member-name-link">fieldsConsumer</a><wbr>(<a href="../../index/SegmentWriteState.html" title="class in org.apache.lucene.index">SegmentWriteState</a>&nbsp;state)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a <a href="../DocValuesConsumer.html" title="class in org.apache.lucene.codecs"><code>DocValuesConsumer</code></a> to write docvalues to the index.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../DocValuesProducer.html" title="class in org.apache.lucene.codecs">DocValuesProducer</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#fieldsProducer(org.apache.lucene.index.SegmentReadState)" class="member-name-link">fieldsProducer</a><wbr>(<a href="../../index/SegmentReadState.html" title="class in org.apache.lucene.index">SegmentReadState</a>&nbsp;state)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a <a href="../DocValuesProducer.html" title="class in org.apache.lucene.codecs"><code>DocValuesProducer</code></a> to read docvalues from the index.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.lucene.codecs.DocValuesFormat">Methods inherited from class&nbsp;org.apache.lucene.codecs.<a href="../DocValuesFormat.html" title="class in org.apache.lucene.codecs">DocValuesFormat</a></h3>
<code><a href="../DocValuesFormat.html#availableDocValuesFormats()">availableDocValuesFormats</a>, <a href="../DocValuesFormat.html#forName(java.lang.String)">forName</a>, <a href="../DocValuesFormat.html#getName()">getName</a>, <a href="../DocValuesFormat.html#reloadDocValuesFormats(java.lang.ClassLoader)">reloadDocValuesFormats</a>, <a href="../DocValuesFormat.html#toString()">toString</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone--" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals-java.lang.Object-" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize--" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass--" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode--" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify--" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll--" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait--" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait-long-" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait-long-int-" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>Lucene90DocValuesFormat</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">Lucene90DocValuesFormat</span>()</div>
<div class="block">Default constructor.</div>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(int)">
<h3>Lucene90DocValuesFormat</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">Lucene90DocValuesFormat</span><wbr><span class="parameters">(int&nbsp;skipIndexIntervalSize)</span></div>
<div class="block">Doc values fields format with specified skipIndexIntervalSize.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="fieldsConsumer(org.apache.lucene.index.SegmentWriteState)">
<h3>fieldsConsumer</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../DocValuesConsumer.html" title="class in org.apache.lucene.codecs">DocValuesConsumer</a></span>&nbsp;<span class="element-name">fieldsConsumer</span><wbr><span class="parameters">(<a href="../../index/SegmentWriteState.html" title="class in org.apache.lucene.index">SegmentWriteState</a>&nbsp;state)</span>
                                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block"><span class="description-from-type-label">Description copied from class:&nbsp;<code><a href="../DocValuesFormat.html#fieldsConsumer(org.apache.lucene.index.SegmentWriteState)">DocValuesFormat</a></code></span></div>
<div class="block">Returns a <a href="../DocValuesConsumer.html" title="class in org.apache.lucene.codecs"><code>DocValuesConsumer</code></a> to write docvalues to the index.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../DocValuesFormat.html#fieldsConsumer(org.apache.lucene.index.SegmentWriteState)">fieldsConsumer</a></code>&nbsp;in class&nbsp;<code><a href="../DocValuesFormat.html" title="class in org.apache.lucene.codecs">DocValuesFormat</a></code></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="fieldsProducer(org.apache.lucene.index.SegmentReadState)">
<h3>fieldsProducer</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../DocValuesProducer.html" title="class in org.apache.lucene.codecs">DocValuesProducer</a></span>&nbsp;<span class="element-name">fieldsProducer</span><wbr><span class="parameters">(<a href="../../index/SegmentReadState.html" title="class in org.apache.lucene.index">SegmentReadState</a>&nbsp;state)</span>
                                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block"><span class="description-from-type-label">Description copied from class:&nbsp;<code><a href="../DocValuesFormat.html#fieldsProducer(org.apache.lucene.index.SegmentReadState)">DocValuesFormat</a></code></span></div>
<div class="block">Returns a <a href="../DocValuesProducer.html" title="class in org.apache.lucene.codecs"><code>DocValuesProducer</code></a> to read docvalues from the index.

 <p>NOTE: by the time this call returns, it must hold open any files it will need to use; else,
 those files may be deleted. Additionally, required files may be deleted during the execution of
 this call before there is a chance to open them. Under these circumstances an IOException
 should be thrown by the implementation. IOExceptions are expected and will automatically cause
 a retry of the segment opening logic with the newly revised segments.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../DocValuesFormat.html#fieldsProducer(org.apache.lucene.index.SegmentReadState)">fieldsProducer</a></code>&nbsp;in class&nbsp;<code><a href="../DocValuesFormat.html" title="class in org.apache.lucene.codecs">DocValuesFormat</a></code></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><i>Copyright &copy; 2000-2025 Apache Software Foundation. All Rights Reserved.</i></small></p>
</footer>
</div>
</div>
</body>
</html>
