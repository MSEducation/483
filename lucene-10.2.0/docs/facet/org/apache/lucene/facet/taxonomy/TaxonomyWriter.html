<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Fri Apr 04 15:37:30 CEST 2025 -->
<title>TaxonomyWriter (Lucene 10.2.0 facet API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-04-04">
<meta name="description" content="declaration: package: org.apache.lucene.facet.taxonomy, interface: TaxonomyWriter">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/TaxonomyWriter.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.lucene.facet.taxonomy</a></div>
<h1 title="Interface TaxonomyWriter" class="title">Interface TaxonomyWriter</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code>, <code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/Closeable.html" title="class or interface in java.io" class="external-link">Closeable</a></code>, <code><a href="../../../../../../core/org/apache/lucene/index/TwoPhaseCommit.html" title="class or interface in org.apache.lucene.index" class="external-link">TwoPhaseCommit</a></code></dd>
</dl>
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="directory/DirectoryTaxonomyWriter.html" title="class in org.apache.lucene.facet.taxonomy.directory">DirectoryTaxonomyWriter</a></code>, <code><a href="directory/ReindexingEnrichedDirectoryTaxonomyWriter.html" title="class in org.apache.lucene.facet.taxonomy.directory">ReindexingEnrichedDirectoryTaxonomyWriter</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">TaxonomyWriter</span><span class="extends-implements">
extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/Closeable.html" title="class or interface in java.io" class="external-link">Closeable</a>, <a href="../../../../../../core/org/apache/lucene/index/TwoPhaseCommit.html" title="class or interface in org.apache.lucene.index" class="external-link">TwoPhaseCommit</a></span></div>
<div class="block">TaxonomyWriter is the interface which the faceted-search library uses to dynamically build the
 taxonomy at indexing time.

 <p>Notes about concurrent access to the taxonomy:

 <p>An implementation must allow multiple readers and a single writer to be active concurrently.
 Readers follow so-called "point in time" semantics, i.e., a reader object will only see taxonomy
 entries which were available at the time it was created. What the writer writes is only available
 to (new) readers after the writer's commit() is called.

 <p>Faceted search keeps two indices - namely Lucene's main index, and this taxonomy index. When
 one or more readers are active concurrently with the writer, care must be taken to avoid an
 inconsistency between the state of these two indices: When writing to the indices, the taxonomy
 must always be committed to disk *before* the main index, because the main index refers to
 categories listed in the taxonomy. Such control can best be achieved by turning off the main
 index's "autocommit" feature, and explicitly calling commit() for both indices (first for the
 taxonomy, then for the main index). In old versions of Lucene (2.2 or earlier), when autocommit
 could not be turned off, a more complicated solution needs to be used. E.g., use some sort of
 (possibly inter-process) locking to ensure that a reader is being opened only right after both
 indices have been flushed (and before anything else is written to them).</div>
<dl class="notes">
<dt>WARNING: This API is experimental and might change in incompatible ways in the next release.</dt>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#addCategory(org.apache.lucene.facet.taxonomy.FacetLabel)" class="member-name-link">addCategory</a><wbr>(<a href="FacetLabel.html" title="class in org.apache.lucene.facet.taxonomy">FacetLabel</a>&nbsp;categoryPath)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">addCategory() adds a category with a given path name to the taxonomy, and returns its ordinal.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.Entry.html" title="class or interface in java.util" class="external-link">Map.Entry</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getLiveCommitData()" class="member-name-link">getLiveCommitData</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the commit user data iterable that was set on <a href="#setLiveCommitData(java.lang.Iterable)"><code>setLiveCommitData(Iterable)</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getParent(int)" class="member-name-link">getParent</a><wbr>(int&nbsp;ordinal)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">getParent() returns the ordinal of the parent category of the category with the given ordinal.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getSize()" class="member-name-link">getSize</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">getSize() returns the number of categories in the taxonomy.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setLiveCommitData(java.lang.Iterable)" class="member-name-link">setLiveCommitData</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.Entry.html" title="class or interface in java.util" class="external-link">Map.Entry</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&gt;&nbsp;commitUserData)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sets the commit user data iterable.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.io.Closeable">Methods inherited from interface&nbsp;java.io.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/Closeable.html" title="class or interface in java.io" class="external-link">Closeable</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/Closeable.html#close--" title="class or interface in java.io" class="external-link">close</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.lucene.index.TwoPhaseCommit">Methods inherited from interface&nbsp;org.apache.lucene.index.<a href="../../../../../../core/org/apache/lucene/index/TwoPhaseCommit.html" title="class or interface in org.apache.lucene.index" class="external-link">TwoPhaseCommit</a></h3>
<code><a href="../../../../../../core/org/apache/lucene/index/TwoPhaseCommit.html#commit()" title="class or interface in org.apache.lucene.index" class="external-link">commit</a>, <a href="../../../../../../core/org/apache/lucene/index/TwoPhaseCommit.html#prepareCommit()" title="class or interface in org.apache.lucene.index" class="external-link">prepareCommit</a>, <a href="../../../../../../core/org/apache/lucene/index/TwoPhaseCommit.html#rollback()" title="class or interface in org.apache.lucene.index" class="external-link">rollback</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="addCategory(org.apache.lucene.facet.taxonomy.FacetLabel)">
<h3>addCategory</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">addCategory</span><wbr><span class="parameters">(<a href="FacetLabel.html" title="class in org.apache.lucene.facet.taxonomy">FacetLabel</a>&nbsp;categoryPath)</span>
         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">addCategory() adds a category with a given path name to the taxonomy, and returns its ordinal.
 If the category was already present in the taxonomy, its existing ordinal is returned.

 <p>Before adding a category, addCategory() makes sure that all its ancestor categories exist in
 the taxonomy as well. As result, the ordinal of a category is guaranteed to be smaller then the
 ordinal of any of its descendants.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getParent(int)">
<h3>getParent</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">getParent</span><wbr><span class="parameters">(int&nbsp;ordinal)</span>
       throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">getParent() returns the ordinal of the parent category of the category with the given ordinal.

 <p>When a category is specified as a path name, finding the path of its parent is as trivial as
 dropping the last component of the path. getParent() is functionally equivalent to calling
 getPath() on the given ordinal, dropping the last component of the path, and then calling
 getOrdinal() to get an ordinal back.

 <p>If the given ordinal is the ROOT_ORDINAL, an INVALID_ORDINAL is returned. If the given
 ordinal is a top-level category, the ROOT_ORDINAL is returned. If an invalid ordinal is given
 (negative or beyond the last available ordinal), an IndexOutOfBoundsException is thrown.
 However, it is expected that getParent will only be called for ordinals which are already known
 to be in the taxonomy. TODO (Facet): instead of a getParent(ordinal) method, consider having a

 <p>getCategory(categorypath, prefixlen) which is similar to addCategory except it doesn't add
 new categories; This method can be used to get the ordinals of all prefixes of the given
 category, and it can use exactly the same code and cache used by addCategory() so it means less
 code.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSize()">
<h3>getSize</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">getSize</span>()</div>
<div class="block">getSize() returns the number of categories in the taxonomy.

 <p>Because categories are numbered consecutively starting with 0, it means the taxonomy
 contains ordinals 0 through getSize()-1.

 <p>Note that the number returned by getSize() is often slightly higher than the number of
 categories inserted into the taxonomy; This is because when a category is added to the
 taxonomy, its ancestors are also added automatically (including the root, which always get
 ordinal 0).</div>
</section>
</li>
<li>
<section class="detail" id="setLiveCommitData(java.lang.Iterable)">
<h3>setLiveCommitData</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">setLiveCommitData</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.Entry.html" title="class or interface in java.util" class="external-link">Map.Entry</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&gt;&nbsp;commitUserData)</span></div>
<div class="block">Sets the commit user data iterable. See <a href="../../../../../../core/org/apache/lucene/index/IndexWriter.html#setLiveCommitData(java.lang.Iterable)" title="class or interface in org.apache.lucene.index" class="external-link"><code>IndexWriter.setLiveCommitData(java.lang.Iterable&lt;java.util.Map.Entry&lt;java.lang.String, java.lang.String&gt;&gt;)</code></a>.</div>
</section>
</li>
<li>
<section class="detail" id="getLiveCommitData()">
<h3>getLiveCommitData</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.Entry.html" title="class or interface in java.util" class="external-link">Map.Entry</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&gt;</span>&nbsp;<span class="element-name">getLiveCommitData</span>()</div>
<div class="block">Returns the commit user data iterable that was set on <a href="#setLiveCommitData(java.lang.Iterable)"><code>setLiveCommitData(Iterable)</code></a>.</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><i>Copyright &copy; 2000-2025 Apache Software Foundation. All Rights Reserved.</i></small></p>
</footer>
</div>
</div>
</body>
</html>
