<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Fri Apr 04 15:37:45 CEST 2025 -->
<title>org.apache.lucene.monitor (Lucene 10.2.0 monitor API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-04-04">
<meta name="description" content="declaration: package: org.apache.lucene.monitor">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#package">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Package:</p>
<ul>
<li><a href="#package-description">Description</a></li>
<li>Related Packages</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Package:&nbsp;</li>
<li><a href="#package-description">Description</a>&nbsp;|&nbsp;</li>
<li>Related Packages&nbsp;|&nbsp;</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Package org.apache.lucene.monitor" class="title">Package org.apache.lucene.monitor</h1>
</div>
<hr>
<div class="package-signature">package <span class="element-name">org.apache.lucene.monitor</span></div>
<section class="package-description" id="package-description">
<div class="block"><h2 id="monitoring-framework-heading">Monitoring framework</h2>

 This package contains classes to allow the monitoring of a stream of documents with a set of
 queries.

 <p>To use, instantiate a <a href="Monitor.html" title="class in org.apache.lucene.monitor"><code>Monitor</code></a> object, register queries with
 it via <a href="Monitor.html#register(org.apache.lucene.monitor.MonitorQuery...)"><code>Monitor.register(org.apache.lucene.monitor.MonitorQuery...)</code></a>, and then
 match documents against it either individually via <a href="Monitor.html#match(org.apache.lucene.document.Document,org.apache.lucene.monitor.MatcherFactory)"><code>Monitor.match(org.apache.lucene.document.Document, org.apache.lucene.monitor.MatcherFactory)</code></a> or in batches via <a href="Monitor.html#match(org.apache.lucene.document.Document%5B%5D,org.apache.lucene.monitor.MatcherFactory)"><code>Monitor.match(org.apache.lucene.document.Document[], org.apache.lucene.monitor.MatcherFactory)</code></a>

 <h3 id="matcher-types-heading">Matcher types</h3>

 A number of matcher types are included:

 <ul>
   <li><a href="QueryMatch.html#SIMPLE_MATCHER"><code>QueryMatch.SIMPLE_MATCHER</code></a> &mdash; just returns the set of
       query ids that a Document has matched
   <li><a href="ScoringMatch.html#matchWithSimilarity(org.apache.lucene.search.similarities.Similarity)"><code>ScoringMatch.matchWithSimilarity(org.apache.lucene.search.similarities.Similarity)</code></a>
       &mdash; returns the set of matching queries, with the score that each one records against a
       Document
   <li><a href="ExplainingMatch.html#MATCHER"><code>&mdash; similar to ScoringMatch,
       but include the full Explanation</code></a>
   <li><a href="HighlightsMatch.html#MATCHER"><code>&mdash; return the matching
       queries along with the matching terms for each query</code></a>
 </ul>

 Matchers can be wrapped in <a href="PartitionMatcher.html" title="class in org.apache.lucene.monitor"><code>PartitionMatcher</code></a> or <a href="ParallelMatcher.html" title="class in org.apache.lucene.monitor"><code>ParallelMatcher</code></a> to increase performance in low-concurrency systems.

 <h3 id="pre-filtering-of-queries-heading">Pre-filtering of queries</h3>

 Monitoring is done efficiently by extracting minimal sets of terms from queries, and using these
 to build a query index. When a document is passed to <a href="Monitor.html#match(org.apache.lucene.document.Document,org.apache.lucene.monitor.MatcherFactory)"><code>Monitor.match(org.apache.lucene.document.Document, org.apache.lucene.monitor.MatcherFactory)</code></a>, it is converted into a small index, and the terms
 dictionary from that index is then used to build a disjunction query to run against the query
 index. Queries that match this disjunction are then run against the document. In this way, the
 Monitor can avoid running queries that have no chance of matching. The process of extracting
 terms and building document disjunctions is handled by a <a href="Presearcher.html" title="class in org.apache.lucene.monitor"><code>Presearcher</code></a>

 <p>In addition, extra per-field filtering can be specified by passing a set of keyword fields to
 filter on. When queries are registered with the monitor, field-value pairs can be added as
 optional metadata for each query, and these can then be used to restrict which queries a document
 is checked against. For example, you can specify a language that each query should apply to, and
 documents containing a value in their language field would only be checked against queries that
 have that same value in their language metadata. Note that when matching documents in batches,
 all documents in the batch must have the same values in their filter fields.

 <p>Query analysis uses the <a href="../../../../../core/org/apache/lucene/search/QueryVisitor.html" title="class or interface in org.apache.lucene.search" class="external-link"><code>QueryVisitor</code></a> API to extract terms,
 which will work for all basic term-based queries shipped with Lucene. The analyzer builds a
 representation of the query called a <a href="QueryTree.html" title="class in org.apache.lucene.monitor"><code>QueryTree</code></a>, and then
 selects a minimal set of terms, one of which must be present in a document for that document to
 match. Individual terms are weighted using a <a href="TermWeightor.html" title="interface in org.apache.lucene.monitor"><code>TermWeightor</code></a>,
 which allows some selectivity when building the term set. For example, given a conjunction of
 terms (a boolean query with several MUST clauses, or a phrase, span or interval query), we need
 only extract one term. The TermWeightor can be configured in a number of ways; by default it will
 weight longer terms more highly.

 <p>For query sets that contain many conjunctions, it can be useful to extract and index different
 minimal term combinations. For example, a phrase query on 'the quick brown fox' could index both
 'quick' and 'brown', and avoid being run against documents that contain only one of these terms.
 The <a href="MultipassTermFilteredPresearcher.html" title="class in org.apache.lucene.monitor"><code>MultipassTermFilteredPresearcher</code></a> allows this sort of
 indexing, taking a minimum term weight so that very common terms such as 'the' can be avoided.

 <p>Custom Query implementations that are based on term matching, and that implement <a href="../../../../../core/org/apache/lucene/search/Query.html#visit(org.apache.lucene.search.QueryVisitor)" title="class or interface in org.apache.lucene.search" class="external-link"><code>Query.visit(org.apache.lucene.search.QueryVisitor)</code></a> will work with no
 extra configuration; for more complicated custom queries, you can register a <a href="CustomQueryHandler.html" title="interface in org.apache.lucene.monitor"><code>CustomQueryHandler</code></a> with the presearcher. Included in this package is a
 <a href="RegexpQueryHandler.html" title="class in org.apache.lucene.monitor"><code>RegexpQueryHandler</code></a>, which gives an example of a different
 method of indexing automaton-based queries by extracting fixed substrings from a regular
 expression, and then using ngram filtering to build the document disjunction.

 <h3 id="persistent-query-sets-heading">Persistent query sets</h3>

 By default, <a href="Monitor.html" title="class in org.apache.lucene.monitor"><code>Monitor</code></a> instances are ephemeral, storing their
 query indexes in memory. To make a persistent monitor, build a <a href="MonitorConfiguration.html" title="class in org.apache.lucene.monitor"><code>MonitorConfiguration</code></a> object and call <a href="MonitorConfiguration.html#setIndexPath(java.nio.file.Path,org.apache.lucene.monitor.MonitorQuerySerializer)"><code>MonitorConfiguration.setIndexPath(java.nio.file.Path, org.apache.lucene.monitor.MonitorQuerySerializer)</code></a> to tell the Monitor to store its query index
 on disk. All queries registered with this Monitor will need to have a string representation that
 is also stored, and can be re-parsed by the associated <a href="MonitorQuerySerializer.html" title="interface in org.apache.lucene.monitor"><code>MonitorQuerySerializer</code></a> when the index is loaded by a new Monitor
 instance.</div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div id="class-summary">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="class-summary-tab0" role="tab" aria-selected="true" aria-controls="class-summary.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary', 2)" class="active-table-tab">All Classes and Interfaces</button><button id="class-summary-tab1" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab1', 2)" class="table-tab">Interfaces</button><button id="class-summary-tab2" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab2', 2)" class="table-tab">Classes</button><button id="class-summary-tab4" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab4', 2)" class="table-tab">Record Classes</button></div>
<div id="class-summary.tabpanel" role="tabpanel">
<div class="summary-table two-column-summary" aria-labelledby="class-summary-tab0">
<div class="table-header col-first">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="CandidateMatcher.html" title="class in org.apache.lucene.monitor">CandidateMatcher</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Class used to match candidate queries selected by a Presearcher from a Monitor query index.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="ConcurrentQueryLoader.html" title="class in org.apache.lucene.monitor">ConcurrentQueryLoader</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Utility class for concurrently loading queries into a Monitor.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="CustomQueryHandler.html" title="interface in org.apache.lucene.monitor">CustomQueryHandler</a></div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Builds a <a href="QueryTree.html" title="class in org.apache.lucene.monitor"><code>QueryTree</code></a> for a query that needs custom treatment</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="ExplainingMatch.html" title="class in org.apache.lucene.monitor">ExplainingMatch</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A query match containing the score explanation of the match</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="HighlightsMatch.html" title="class in org.apache.lucene.monitor">HighlightsMatch</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">QueryMatch object that contains the hit positions of a matching Query</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab4"><a href="HighlightsMatch.Hit.html" title="class in org.apache.lucene.monitor">HighlightsMatch.Hit</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab4">
<div class="block">Represents an individual hit</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="MatcherFactory.html" title="interface in org.apache.lucene.monitor">MatcherFactory</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Interface for the creation of new CandidateMatcher objects</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="MatchingQueries.html" title="class in org.apache.lucene.monitor">MatchingQueries</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Class to hold the results of matching a single <a href="../../../../../core/org/apache/lucene/document/Document.html" title="class or interface in org.apache.lucene.document" class="external-link"><code>Document</code></a>
 against queries held in the Monitor</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="Monitor.html" title="class in org.apache.lucene.monitor">Monitor</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">A Monitor contains a set of <a href="../../../../../core/org/apache/lucene/search/Query.html" title="class or interface in org.apache.lucene.search" class="external-link"><code>Query</code></a> objects with associated IDs, and efficiently matches
 them against sets of <a href="../../../../../core/org/apache/lucene/document/Document.html" title="class or interface in org.apache.lucene.document" class="external-link"><code>Document</code></a> objects.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab4"><a href="Monitor.QueryCacheStats.html" title="class in org.apache.lucene.monitor">Monitor.QueryCacheStats</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab4">
<div class="block">Statistics for the query cache and query index</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="MonitorConfiguration.html" title="class in org.apache.lucene.monitor">MonitorConfiguration</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Encapsulates various configuration settings for a Monitor's query index</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="MonitorQuery.html" title="class in org.apache.lucene.monitor">MonitorQuery</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Defines a query to be stored in a Monitor</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="MonitorQuerySerializer.html" title="interface in org.apache.lucene.monitor">MonitorQuerySerializer</a></div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Serializes and deserializes MonitorQuery objects into byte streams</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="MonitorUpdateListener.html" title="interface in org.apache.lucene.monitor">MonitorUpdateListener</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">For reporting events on a Monitor's query index</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="MultiMatchingQueries.html" title="class in org.apache.lucene.monitor">MultiMatchingQueries</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Class to hold the results of matching a batch of <a href="../../../../../core/org/apache/lucene/document/Document.html" title="class or interface in org.apache.lucene.document" class="external-link"><code>Document</code></a>s
 against queries held in the Monitor</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="MultipassTermFilteredPresearcher.html" title="class in org.apache.lucene.monitor">MultipassTermFilteredPresearcher</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A TermFilteredPresearcher that indexes queries multiple times, with terms collected from
 different routes through a querytree.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="ParallelMatcher.html" title="class in org.apache.lucene.monitor">ParallelMatcher</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Matcher class that runs matching queries in parallel.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="PartitionMatcher.html" title="class in org.apache.lucene.monitor">PartitionMatcher</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A multi-threaded matcher that collects all possible matches in one pass, and then partitions them
 amongst a number of worker threads to perform the actual matching.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="Presearcher.html" title="class in org.apache.lucene.monitor">Presearcher</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">A Presearcher is used by the Monitor to reduce the number of queries actually run against a
 Document.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="PresearcherMatch.html" title="class in org.apache.lucene.monitor">PresearcherMatch</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Wraps a <a href="QueryMatch.html" title="class in org.apache.lucene.monitor"><code>QueryMatch</code></a> with information about which queries were selected by the presearcher</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="PresearcherMatches.html" title="class in org.apache.lucene.monitor">PresearcherMatches</a>&lt;T extends <a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a>&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Wraps a <a href="MultiMatchingQueries.html" title="class in org.apache.lucene.monitor"><code>MultiMatchingQueries</code></a> with information on which presearcher queries were selected</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="QueryDecomposer.html" title="class in org.apache.lucene.monitor">QueryDecomposer</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Split a disjunction query into its consituent parts, so that they can be indexed and run
 separately in the Monitor.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="QueryMatch.html" title="class in org.apache.lucene.monitor">QueryMatch</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Represents a match for a specific query and document</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="QueryTimeListener.html" title="interface in org.apache.lucene.monitor">QueryTimeListener</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">Notified of the time it takes to run individual queries against a set of documents</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="QueryTree.html" title="class in org.apache.lucene.monitor">QueryTree</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">A representation of a node in a query tree</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="RegexpQueryHandler.html" title="class in org.apache.lucene.monitor">RegexpQueryHandler</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A query handler implementation that matches Regexp queries by indexing regex terms by their
 longest static substring, and generates ngrams from Document tokens to match them.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="ScoringMatch.html" title="class in org.apache.lucene.monitor">ScoringMatch</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">A QueryMatch that reports scores for each match</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="SlowLog.html" title="class in org.apache.lucene.monitor">SlowLog</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Reports on slow queries in a given match run</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="SlowLog.Entry.html" title="class in org.apache.lucene.monitor">SlowLog.Entry</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An individual entry in the slow log</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="TermFilteredPresearcher.html" title="class in org.apache.lucene.monitor">TermFilteredPresearcher</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Presearcher implementation that uses terms extracted from queries to index them in the Monitor,
 and builds a disjunction from terms in a document to match them.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="TermFilteredPresearcher.DocumentQueryBuilder.html" title="interface in org.apache.lucene.monitor">TermFilteredPresearcher.DocumentQueryBuilder</a></div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Constructs a document disjunction from a set of terms</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="TermWeightor.html" title="interface in org.apache.lucene.monitor">TermWeightor</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">Calculates the weight of a <a href="../../../../../core/org/apache/lucene/index/Term.html" title="class or interface in org.apache.lucene.index" class="external-link"><code>Term</code></a></div>
</div>
</div>
</div>
</div>
</li>
</ul>
</section>
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><i>Copyright &copy; 2000-2025 Apache Software Foundation. All Rights Reserved.</i></small></p>
</footer>
</div>
</div>
</body>
</html>
