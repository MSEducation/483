[[Vi]]

CATEGORIES: Vi, Unix text editors, Unix SUS2008 utilities, 1976 introductions

vi [tpl]IPAc-en|ˈ|v|iː|ˈ|aɪ[/tpl] is a screen-oriented text editor originally created for the Unix operating system. The portable subset of the behavior of vi and programs based on it, and the ex editor language supported within these programs, is described by (and thus standardized by) the Single Unix Specification and POSIX.[tpl]Cite web | url = http://pubs.opengroup.org/onlinepubs/9699919799/utilities/vi.html | title= "vi — screen-oriented (visual) display editor", The Open Group Base Specifications Issue 7; IEEE Std 1003.1, 2013 Edition | author = The IEEE and The Open Group | accessdate = 2013-07-15 | year = 2013[/tpl]
The original code for vi was written by Bill Joy in 1976, as the visual mode for a line editor called ex that Joy had written with Chuck Haley.Interview with Bill Joy, Unix Review, August 1984 Bill Joy's ex 1.1 was released as part of the first BSD Unix release in March, 1978. It was not until version 2.0 of ex, released as part of Second Berkeley Software Distribution in May, 1979 that the editor was installed under the name vi (which took users straight into ex's visual mode), and the name by which it is known today. Some current implementations of vi can trace their source code ancestry to Bill Joy; others are completely new, largely compatible reimplementations.
The name vi is derived from the shortest unambiguous abbreviation for the command visual in ex; the command in question switches the line editor ex to visual mode. The name vi is pronounced [tpl]IPAc-en|ˈ|v|iː|ˈ|aɪ[/tpl][tpl]cite book | url=http://www.catb.org/~esr/writings/taoup/html/ch15s02.html#vi_literacy | last=Raymond | first=Eric S. | title=The Art of UNIX Programming | date=4 October 2003 | publisher=Addison-Wesley Professional | isbn=0-13-142901-9 | quote=15.2.1:...is pronounced /vee eye/ (not /vie/ and definitely not /siks/!). [/tpl][tpl]cite book | last = Bolsky | first = M. I. | year = 1984 | title = The vi User's Handbook | publisher = AT&T Bell Laboratories | isbn = 0-13-941733-8 [/tpl][tpl]cite book | last = Raymond | first = Eric S | coauthors = Guy L. Steele, Eric S. Raymond | authorlink = Eric S. Raymond | editor = (ed.) | year = 1996 | title = The New Hacker's Dictionary | publisher = MIT Press | edition = 3rd | isbn = 0-262-68092-0 [/tpl] (as in the discrete English letters v and i), or [tpl]IPAc-en|ˈ|v|aɪ[/tpl].[tpl]cite book | last = Gross | first = Christian | year = 2005 | title = Open Source for Windows Administrators | publisher = Charles River Media | isbn = 1-58450-347-5 | pages = 55 [/tpl]
In addition to various non–free software implementations of vi distributed with proprietary implementations of Unix, several free and open source software implementations of vi exist. A 2009 survey of Linux Journal readers found that vi was the most widely used text editor among respondents, beating gedit, the second most widely used editor by nearly a factor of two (36% to 19%).[tpl]Cite journal|url=http://www.linuxjournal.com/article/10451|title=Readers' Choice Awards 2009|last=Gray|first=James|work=Linux Journal|date=1 June 2009|accessdate=2010-01-22|postscript=[tpl]inconsistent citations[/tpl] [/tpl]

==History==

===Creation===

vi was derived from a sequence of UNIX command line editors, starting with ed, which was a line editor designed to work well on teletypes, rather than display terminals. Within AT&T Corporation, where ed originated, people seemed to be happy with an editor as basic and unfriendly as ed, George Coulouris recalls:
 
 ... for many years, they had no suitable terminals. They carried on with TTYs and other printing terminals for a long time, and when they did buy screens for everyone, they got Tektronix 4014s. These were large storage tube displays. You can't run a screen editor on a storage-tube display as the picture can't be updated. Thus it had to fall to someone else to pioneer screen editing for Unix, and that was us initially, and we continued to do so for many years.

Coulouris considered the cryptic commands of ed to be only suitable for "immortals", and thus in February, 1976, he enhanced ed (using Ken Thompson's ed source as a starting point) to make em (the "editor for mortals"Source code for em; February, 1976) while acting as a lecturer at Queen Mary College.A Quarter Century of UNIX, by Peter H. Salus, Addison-Wesley 1994, pages 139–142. (excerpt available online) The em editor was designed for display terminals and was a single-line-at-a-time visual editor. It was one of the first programs on Unix to make heavy use of "raw terminal input mode", in which the running program, rather than the terminal device driver, handled all keystrokes. When Coulouris visited UC Berkeley in the summer of 1976, he brought a DECtape containing em, and showed the editor to various people. Some people considered this new kind of editor to be a potential resource hog, but others, including Bill Joy were impressed.
Inspired by em, and by their own tweaks to ed, Bill Joy and Chuck Haley, both graduate students at UC Berkeley, took code from em to make en,[tpl]cite web | url = http://www.theregister.co.uk/2003/09/11/bill_joys_greatest_gift/ | first=Ashlee |last=Vance |title = Bill Joy's greatest gift to man – the vi editor | work = The Register | date = 11 September 2003 |accessdate=2012-06-30|archiveurl=http://www.webcitation.org/68orSPKiB |archivedate=30 June 2012[/tpl] and then "extended" en to create ex version 0.1. After Haley's departure, Bruce Englar encouraged Joy to redesign the editor,[tpl]Cite journal | url = http://minnie.tuhs.org/cgi-bin/utree.pl?file=4.4BSD/usr/src/usr.bin/ex/USD.doc/ex/ex.rm | title = ex Reference Manual | series = 4.4 BSD (encumbered, not Lite) | last = Joy | first = Bill | publisher = CSRG, UC Berkeley | format = roff source | postscript = [tpl]inconsistent citations[/tpl] [/tpl] (see Acknowlegments section at end of file) which he did June through October 1977 adding a full-screen visual mode to ex.See dates in copyright headers, ex 1.1 source code
Many of the ideas in ex's visual mode (a.k.a. vi) were taken from other software that existed at the time. According to Bill Joy, inspiration for vi's visual mode came from the Bravo editor, which was a bimodal editor. In an interview about vi's origins, Joy said:
 
 A lot of the ideas for the screen editing mode were stolen from a Bravo manual I surreptitiously looked at and copied. Dot is really the double-escape from Bravo, the redo command. Most of the stuff was stolen. There were some things stolen from ed—we got a manual page for the Toronto version of ed, which I think Rob Pike had something to do with. We took some of the regular expression extensions out of that.

Joy used a Lear Siegler ADM3A terminal. On this terminal, the Escape key was at the location now occupied by the Tab key on the widely used IBM PC keyboard (on the left side of the alphabetic part of the keyboard, one row above the middle row). This made it a convenient choice for switching vi modes. Also, the keys h,j,k,l served double duty as cursor movement keys and were inscribed with arrows, which is why vi uses them in that way. The ADM3A had no other cursor keys. Joy explained that the terse, single character commands and the ability to type ahead of the display were a result of the slow 300 baud modem he used when developing the software and that he wanted to be productive when the screen was painting slower than he could think.

===Distribution===

Joy was responsible for creating the first BSD Unix release in March, 1978, and included ex 1.1 (dated 1 February 1978)version.c, ex 1.1 source code in the distribution, thereby exposing his editor to an audience beyond UC Berkeley.READ_ME from the first Berkeley Software Distribution (formatted version) From that release of BSD Unix onwards, the only editors that came with the Unix system were ed and ex. In a 1984 interview, Joy attributed much of the success of vi to the fact that it was bundled for free, whereas other editors, such as Emacs, could cost hundreds of dollars.
Eventually it was observed that most ex users were spending all their time in visual mode,[tpl]Citation needed|date=November 2008[/tpl] and thus in ex 2.0 (released as part of Second Berkeley Software Distribution in May, 1979), Joy created vi as a hard link to ex,makefile, ex 2.0 source code such that when invoked as vi, ex would automatically start up in its visual mode. Thus, vi is not the evolution of ex, vi is ex.
Joy described ex 2.0 (vi) as a very large program, barely able to fit in the memory of a PDP-11/70,READ_ME, ex 2.0 source code thus although vi may be regarded as a small, lightweight, program today, it was not seen that way early in its history. By version 3.1, shipped with 3BSD in December 1979, the full version of vi was no longer able to fit in the memory of a PDP-11.http://minnie.tuhs.org/cgi-bin/utree.pl?file=3bsd/usr/src/cmd/ex/READ_ME, ex 3.1 source code
Joy continued to be lead developer for vi until version 2.7 in June, 1979, and made occasional contributions to vi's development until at least version 3.5 in August, 1980.Change log for vi, versions 2.1–3.7 In discussing the origins of vi and why he discontinued development, Joy said:
 
  I wish we hadn't used all the keys on the keyboard. I think one of the interesting things is that vi is really a mode-based editor. I think as mode-based editors go, it's pretty good. One of the good things about EMACS, though, is its programmability and the modelessness. Those are two ideas which never occurred to me. I also wasn't very good at optimizing code when I wrote vi. I think the redisplay module of the editor is almost intractable. It does a really good job for what it does, but when you're writing programs as you're learning... That's why I stopped working on it. 
 What actually happened was that I was in the process of adding multiwindows to vi when we installed our VAX, which would have been in December of '78. We didn't have any backups and the tape drive broke. I continued to work even without being able to do backups. And then the source code got scrunched and I didn't have a complete listing. I had almost rewritten all of the display code for windows, and that was when I gave up. After that, I went back to the previous version and just documented the code, finished the manual and closed it off. If that scrunch had not happened, vi would have multiple windows, and I might have put in some programmability—but I don't know. 
 The fundamental problem with vi is that it doesn't have a mouse and therefore you've got all these commands. In some sense, its backwards from the kind of thing you'd get from a mouse-oriented thing. I think multiple levels of undo would be wonderful, too. But fundamentally, vi is still ed inside. You can't really fool it. 
 It's like one of those pinatas—things that have candy inside but has layer after layer of paper mache on top. It doesn't really have a unified concept. I think if I were going to go back—I wouldn't go back, but start over again. 

In 1979, Mark Horton took on responsibility for vi. Horton added support for arrow and function keys, macros, and improved performance by replacing termcap with terminfo.[tpl]Cite journal | url = http://minnie.tuhs.org/cgi-bin/utree.pl?file=4.4BSD/usr/src/usr.bin/ex/USD.doc/vi/vi.in | title = vi Reference Manual | series = 4.4 BSD (encumbered, not Lite) | last = Joy | first = Bill | publisher = CSRG, UC Berkeley | format = roff source | postscript = [tpl]inconsistent citations[/tpl] [/tpl] (see Acknowlegments section at end of file)

===Ports and clones===

Up to version 3.7 of vi, created in October, 1981, UC Berkeley was the development home for vi, but with Bill Joy's departure in early 1982, to join Sun Microsystems, and AT&T's UNIX System V (January, 1983) adopting vi,[tpl]cite book|title=UNIX: the complete reference|year=2006|publisher=McGraw-Hill Osborne Media|isbn=978-0-07-226336-7|url=http://books.google.com/books?id=2Et--84HIkwC&lpg=PA10&dq=%2Bvi%20bell%20labs%20system%20v%201983&pg=PA10#v=onepage&q&f=false|author=Kenneth H. Rosen|coauthors=Douglas A. Host, Rachel Klee|accessdate=7 December 2010|page=10 [/tpl] changes to the vi codebase happened more slowly and in a more dispersed and mutually incompatible ways. At UC Berkeley, changes were made but the version number was never updated beyond 3.7. Commercial Unix vendors, such as Sun, HP, DEC, and IBM each received copies of the vi source, and their operating systems, Solaris, HP-UX, Tru64 UNIX, and AIX, today continue to maintain versions of vi directly descended from the 3.7 release, but with added features, such as adjustable key mappings, encryption, and wide character support.
While commercial vendors could work with Bill Joy's codebase (and continue to use it today), many people could not. Because Joy had begun with Ken Thompson's ed editor, ex and vi were derivative works and could not be distributed except to people who had an AT&T source license. People looking for a free Unix-style editor would have to look elsewhere. By 1985, a version of Emacs (MicroEMACS) was available for a variety of platforms, but it was not until June, 1987 that Stevie (ST editor for VI enthusiasts), a limited vi clone appeared.[tpl]Cite web | first=Tim | last=Thompson | date=26 March 2000 | url=http://nosuch.com/tjt/stevie/ | title=Stevie | accessdate=2010-12-29 [/tpl][tpl]cite newsgroup | title=A mini-vi for the ST | author=Tim Thompson | date=28 June 1987 | newsgroup=comp.sys.atari.st | id=129@glimmer.UUCP | url=http://groups.google.com/group/comp.sys.atari.st/msg/8db96f888d778a32?dmode=source | accessdate=2010-12-29 [/tpl] In early January, 1990, Steve Kirkendall posted a new clone of vi, Elvis, to the Usenet newsgroup comp.os.minix, aiming for a more complete and more faithful clone of vi than Stevie. It quickly attracted considerable interest in a number of enthusiast communities.Usenet, various newsgroups (comp.editors, comp.sys.*, comp.os.*), 1990[tpl]cite newsgroup | title=A new clone of vi is coming soon: ELVIS | author=Steve Kirkendall | date=20 April 1990 | newsgroup=comp.editors | id=2719@psueea.UUCP | url=http://groups.google.com/group/comp.editors/msg/f409553df27eb412?dmode=source | accessdate=2010-12-29[/tpl] (discusses January comp.os.minix posting, and design goals) Andrew Tanenbaum quickly asked the community to decide one of these two editors to be the vi clone in Minix;[tpl]cite newsgroup | title=Elvis vs. stevie | author=Andrew S. Tanenbaum | date=18 January 1990 | newsgroup=comp.os.minix | id=5133@ast.cs.vu.nl | url=http://groups.google.com/group/comp.os.minix/msg/e6697b44895069e8?dmode=source | accessdate=2010-12-29 [/tpl] Elvis was chosen, and remains the vi clone for Minix today.
In 1989 Lynne Jolitz and William Jolitz began porting BSD Unix to run on 386 class processors, but to create a free distribution they needed to avoid any AT&T-contaminated code, including Joy's vi. To fill the void left by removing vi, their 1992 386BSD distribution adopted Elvis as its vi replacement. 386BSD's descendants, FreeBSD and NetBSD followed suit. But at UC Berkeley, Keith Bostic wanted a "bug for bug compatible" replacement for Joy's vi for BSD 4.4 Lite. Using Kirkendall's Elvis (version 1.8) as a starting point, Bostic created nvi, releasing it in Spring of 1994. When FreeBSD and NetBSD resynchronized the 4.4-Lite2 codebase, they too switched over to Bostic's nvi, which they continue to use today.
Despite the existence of vi clones with enhanced featuresets, sometime before June, 2000,Changes file, from Traditional Vi by Gunnar Ritter Gunnar Ritter ported Joy's vi codebase (taken from 2.11BSD, February, 1992) to modern Unix-based operating systems, such as Linux and FreeBSD. Initially, his work was technically illegal to distribute without an AT&T source license, but, in January, 2002, those licensing rules were relaxed,Caldera License for 32-bit 32V UNIX and 16 bit UNIX Versions 1, 2, 3, 4, 5, 6, 7 allowing legal distribution as an open-source project. Ritter continued to make small enhancements to the vi codebase similar to those done by commercial Unix vendors still using Joy's codebase, including changes required by the POSIX.2 standard for vi. His work is available as Traditional Vi, and runs today on a variety of systems.
But although Joy's vi was now once again available for BSD Unix, it arrived after the various BSD flavors had committed themselves to nvi, which provides a number of enhancements over traditional vi, and drops some of its legacy features (such as open mode for editing one line at a time). It is in some sense, a strange inversion that BSD Unix, where Joy's vi codebase began, no longer uses it, and the AT&T-derived Unixes, which in the early days lacked Joy's editor, are the ones that now use and maintain modified versions of his code.

===Impact===

Over the years since its creation, vi became the de facto standard Unix editor and a nearly undisputed hacker favorite[tpl]Citation needed|date=August 2010[/tpl] outside of MIT until the rise of Emacs after about 1984. The Single UNIX Specification specifies vi, so every conforming system must have it.
vi is still widely used by users of the Unix family of operating systems. About half the respondents in a 1991 USENET poll preferred vi. In 1999, Tim O'Reilly, founder of the eponymous computer book publishing company, stated that his company sold more copies of its vi book than its emacs book.[tpl]cite web | url = http://www.oreilly.com/pub/a/oreilly/ask_tim/1999/unix_editor.html | title = Ask Tim Archive | publisher = O'Reilly | date = 21 June 1999 [/tpl]

==Interface==

vi is a modal editor: it operates in either insert mode (where typed text becomes part of the document) or normal mode (where keystrokes are interpreted as commands that control the edit session). For example, typing [tpl]keypress|i[/tpl] while in normal mode switches the editor to insert mode, but typing [tpl]keypress|i[/tpl] again at this point places an "i" character in the document. From insert mode, pressing the escape key switches the editor back to normal mode. A perceived advantage of vi's separation of text entry and command modes is that both text editing and command operations can be performed without requiring the removal of the user's hands from the home row. As non-modal editors usually have to reserve all keys with letters and symbols for the printing of characters, any special commands for actions other than adding text to the buffer must be assigned to keys which do not produce characters, such as function keys, or combinations of modifier keys such as [tpl]keypress|Ctrl[/tpl], and [tpl]keypress|Alt[/tpl] with regular keys. Vi has the property that most ordinary keys are connected to some kind of command for positioning, altering text, searching and so forth, either singly or in key combinations. Many commands can be touch typed without the use of [tpl]keypress|Shift[/tpl],[tpl]keypress|Ctrl[/tpl] or [tpl]keypress|Alt[/tpl]. Other types of editors generally require the user to move their hands from the home row when touch typing:
For instance, replacing a word is [tpl]keypress|c[/tpl][tpl]keypress|w[/tpl]replacement text[tpl]keypress|Escape[/tpl] which is a combination of two independent commands (change and word-motion) together with a transition into and out of insert mode. Text between the cursor position and the end of the word is overwritten by the replacement text. The operation can be repeated at some other location by typing [tpl]keypress|.[/tpl], the effect being that the word starting that location will be replaced with the same replacement text.

==Contemporary derivatives and clones==

 
 Compared to most of its many clones, the original vi is
a rather small program (~120 KB code on i386) just with its extremely
powerful editing interface, but lacking fancy features like multiple
undo, multiple screens or syntax highlighting. In other words, it is a
typical Unix program that does exactly what it should and nothing more.

==See also==

==References==

==Further reading==

==External links==


