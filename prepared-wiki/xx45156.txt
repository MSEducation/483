[[SQL Slammer]]

CATEGORIES: Exploit-based worms, Denial-of-service attacks

SQL Slammer is a computer worm that caused a denial of service on some Internet hosts and dramatically slowed down general Internet traffic, starting at 05:30 UTC on January 25, 2003. It spread rapidly, infecting most of its 75,000 victims within ten minutes. So named by Christopher J. Rouland, the CTO of ISS, Slammer was first brought to the attention of the public by Michael Bacarella (see notes below). Although titled "SQL slammer worm", the program did not use the SQL language; it exploited a buffer overflow bug in Microsoft's flagship SQL Server and Desktop Engine database products, for which a patch had been released six months earlier in MS02-039. Other names include W32.SQLExp.Worm, DDOS.SQLP1434.A, the Sapphire Worm, SQL_HEL, W32/SQLSlammer and Helkern.[tpl]cite web |url=http://www.symantec.com/security_response/writeup.jsp?docid=2003-012502-3306-99 |title=Symantec W32.SQLExp.Worm[/tpl]

==Technical details==

The worm was based on proof of concept code demonstrated at the Black Hat Briefings by David Litchfield, who had initially discovered the buffer overflow vulnerability that the worm exploited.[tpl]cite news|first=John |last=Leyden|url=http://www.theregister.co.uk/2003/02/06/slammer_why_security_benefits/ |title=Slammer: Why security benefits from proof of concept code |publisher=Register | date=6 February 2003 |accessdate=2008-11-29[/tpl] It is a small piece of code that does little other than generate random IP addresses and send itself out to those addresses. If a selected address happens to belong to a host that is running an unpatched copy of Microsoft SQL Server Resolution Service, the host immediately becomes infected and begins spraying the Internet with more copies of the worm program.
Home PCs are generally not vulnerable to this worm unless they have MSDE installed. The worm is so small that it does not contain code to write itself to disk, so it only stays in memory, and it is easy to remove. For example, Symantec provides a free removal utility (see external link below), or it can even be removed by restarting SQL Server (although the machine would likely be reinfected immediately).
The worm was made possible by a software security vulnerability in SQL Server first reported by Microsoft on July 24, 2002. A patch had been available from Microsoft for six months prior to the worm's launch, but many installations had not been patched – including many at Microsoft.
The slowdown was caused by the collapse of numerous routers under the burden of extremely high bombardment traffic from infected servers. Normally, when traffic is too high for routers to handle, the routers are supposed to delay or temporarily stop network traffic. Instead, some routers crashed (became unusable), and the "neighbour" routers would notice that these routers had stopped and should not be contacted (aka "removed from the routing table"). Routers started sending notices to this effect to other routers they knew about. The flood of routing table update notices caused some additional routers to fail, compounding the problem. Eventually the crashed routers' maintainers restarted them, causing them to announce their status, leading to another wave of routing table updates. Soon a significant portion of Internet bandwidth was consumed by routers communicating with each other to update their routing tables, and ordinary data traffic slowed down or in some cases stopped altogether. Ironically, because the SQL Slammer worm was so small in size, sometimes it was able to get through when legitimate traffic was not.
Two key aspects contributed to SQL Slammer's rapid propagation. The worm infected new hosts over UDP, and the entire worm (only 376 bytes) fits inside a single packet.[tpl]cite web|authors=Moore, David et al|title=The Spread of the Sapphire/Slammer Worm|work=CAIDA (Cooperative Association for Internet Data Analysis)|url=http://www.caida.org/outreach/papers/2003/sapphire/sapphire.html[/tpl][tpl]cite book|authors=Serazzi, Giuseppe & Zanero, Stefano|chapter=Computer Virus Propagation Models|editors=Calzarossa, Maria Carla & Gelenbe, Erol|title=Performance Tools and Applications to Networked Systems|series=Lecture Notes in Computer Science|volume=Vol. 2965|year=2004|pages=26-50|url=http://home.deib.polimi.it/zanero/papers/zanero-serazzi-virus.pdf[/tpl] As a result, each infected host could instead simply "fire and forget" packets as rapidly as possible (generally hundreds per second).

==Notes==

There is contention as to who found "Slammer" first. This is almost impossible to determine. However, in terms of who first alerted the general public, this can be attributed to Michael Bacarella, who posted a message to the Bugtraq security mailing list entitled "MS SQL WORM IS DESTROYING INTERNET BLOCK PORT 1434!".[tpl]cite web|first=Michael |last=Bacarella |url=http://seclists.org/bugtraq/2003/Jan/221 |title=MS SQL WORM IS DESTROYING INTERNET BLOCK PORT 1434! |publisher=Bugtraq |date=25 January 2003 |accessdate=2012-11-29[/tpl] This was sent at 07:11:41 UTC on 25 January 2003. Ben Koshy is often credited as being the first; indeed the company he worked for put out a press statement to this effect.[tpl]cite web |url=http://www.w3media.com/images/news/W3_Identify_Slammer_Virus.pdf |title=W3 Media's Ben Koshy first to identify Internet 'Slammer' Virus |work=Press Release |publisher=W3 Media |date=January 24, 2003 |accessdate=2008-11-29[/tpl] However, his alert[tpl]cite web|first=Ben |last=Koshy |url=http://archives.neohapsis.com/archives/ntbugtraq/2003-q1/0010.html |title=Peace of Mind Through Integrity and Insight |publisher=Neohapsis Archives |date=January 25, 2003 |accessdate=2008-11-29[/tpl] to the public, sent to the NTBugtraq mailing list was not sent until 10:28 UTC. Robert Boyle sent an alert to NTBugtraq at 08:35 UTC[tpl]cite web|first=Robert |last=Boyle |url=http://archives.neohapsis.com/archives/ntbugtraq/2003-q1/0011.html |title=Peace of Mind Through Integrity and Insight |publisher=Neohapsis Archives |date=January 25, 2003 |accessdate=2008-11-29[/tpl] beating Koshy but lagging behind Bacarella. ISS, through Chris Rouland, sent out alerts at 11:54 UTC[tpl]cite web|url=http://lists.virus.org/issforum-0301/msg00099.html |title=ISS Security Brief: Microsoft SQL Slammer Worm Propagation |work=ISSForum |date=25 January 2003 |accessdate=2008-11-29[/tpl] and 11:56 UTC[tpl]cite web|author=X-Force |url=http://archives.neohapsis.com/archives/vulnwatch/2003-q1/0038.html |title=Peace of Mind Through Integrity and Insight |publisher=Neohapsis Archives |date=January 25, 2003 |accessdate=2008-11-29[/tpl] to the ISSForum and Vulnwatch mailing lists respectively. An analysis released by Symantec is timestamped 07:45 GMT, which would precede these public announcements.[tpl]cite web|url=http://securityresponse.symantec.com/avcenter/Analysis-SQLExp.pdf |publisher=DeepSight™ Threat Management System Threat Analysis |title=SQLExp SQL Server Worm Analysis |date=Jan 28, 2003[/tpl]

==References==

==External links==


