[[Purple (cipher machine)]]

CATEGORIES: Encryption devices, Attack on Pearl Harbor, Japanâ€“United States relations

In the history of cryptography, , codenamed Purple by the United States, was a diplomatic cryptographic machine used by the Japanese Foreign Office just before and during World War II. The machine was an electromechanical stepping-switch device.
The information gained from decryptions was eventually code-named Magic within the US government.
The codename "Purple" referred to binders used by US cryptanalysts for material produced by various systems; it replaced the Red machine used by the Japanese Foreign Office. The Japanese also used Coral and JADE stepping-switch systems.

Development of Japanese cipher machines

Overview

The Japanese Navy did not cooperate with the Army in pre-war cipher machine development, and that lack of cooperation continued into the World War 2.  The Navy believed the Purple machine was sufficiently difficult to break that it did not attempt to revise it to improve security. This seems to have been on the advice of a mathematician,   The Ministry of Foreign Affairs was supplied Red and Purple by the Navy. No one noticed weak points in both machines.
Just before the end of the war, the Army warned the Navy of a weak point of Purple, but the Navy failed to act on this advice.
The Army developed their own cipher machines on the same principle as Enigma,  from 1932 to 1941. The Army judged that these machines had lower security than the Navy's Purple design, so the Army's two cipher machines were less used.

Prototype of Red

Japanese diplomatic communications at negotiations for the Washington Naval Treaty were broken by the American Black Chamber in 1922, and when this became publicly known, there was considerable pressure to improve their security. In any case, the Japanese Navy had planned to develop their first cipher machine for the following London Naval Treaty. Japanese Navy Captain , of Section 10 (cipher & code) of the Japanese Navy General Staff Office, supervised the work.
The development of the machine was the responsibility of the Japanese Navy Institute of Technology, Electric Research Department, Section 6. In 1928, the chief designer .
The prototype used the same principle as the Kryha cipher machine, having a plug-board, and was used by the Japanese Navy and Ministry of Foreign Affairs at negotiations for the London Naval Treaty in 1930.

Red

The prototype machine was finally completed as  in 1931. The year 1931 was year 2591 in the Japanese Imperial calendar. Thus it was prefixed "91-shiki" from the year it was developed.
The 91-shiki injiki Roman-letter model was also used by the Ministry of Foreign Affairs as , codenamed "Red" by United States cryptanalysts.
The Red machine was unreliable unless the contacts in its half-rotor switch were cleaned every day. It enciphered vowels (AEIOUY) and consonants separately, perhaps to reduce telegram costs, and this was a significant weak point. The Navy also used the 91-shiki injiki Kana-letter model at its bases and on its vessels.

Purple

In 1937, the Japanese completed the next generation , codenamed Purple by United States cryptanalysts.
The chief designer of Purple was . Eikichi Suzuki suggested the use of a stepping switch instead of the more troublesome half-rotor switch.
Clearly, the Purple machine was more secure than Red, but the Navy did not recognize that Red had already been broken. The Purple machine inherited a weakness from the Red machine that six letters of the alphabet were encrypted separately. It differed from RED in that the group of letters was changed and announced every nine days, whereas in RED they were permanently fixed as the English vowels 'a', 'e', 'i', 'o', 'u' and 'y'. Thus US Army SIS was able to break the cipher used for the six letters before it was able to break the one used for the 20 others.

Weaknesses and cryptanalysis

In operation, the enciphering machine accepted typewritten input (in the Roman alphabet) and produced ciphertext output, and vice versa when deciphering messages. The result was a potentially excellent cryptosystem. In fact, operational errors, chiefly in key choice, made the system less secure than it could have been; in that way the Purple code shared the fate of the German Enigma machine. The cipher was broken by a team from the US Army Signals Intelligence Service, then directed by William Friedman in 1940. Reconstruction of the Purple machine was based on ideas of Larry Clark. Advances into the understanding of Purple keying procedures were made by Lt Francis A. Raven, USN. Raven discovered that the Japanese had divided the month into three 10-days periods, and within each period they used the keys of the first day with small predictable changes.
The Japanese believed it to be unbreakable throughout the war, and even for some time after the war, even though they had been informed otherwise by the Germans. In April 1941, Hans Thomsen, a diplomat at the German embassy in Washington, D.C., sent a message to Joachim von Ribbentrop, the German foreign minister, informing him that "an absolutely reliable source" had told Thomsen that the Americans had broken the Japanese diplomatic cipher (that is, Purple). That source apparently was Konstantin Umansky, the Soviet ambassador to the US, who had deduced the leak based upon communications from Sumner Welles. The message was duly forwarded to the Japanese; but use of the code continued.
[ref]
 Text from excerpt of first chapter on WNYC website[/ref]
The United States obtained portions of a Purple machine from the Japanese Embassy in Germany following Germany's defeat in 1945 (see image above) and discovered that the Japanese had used precisely the same "stepping switch" in its construction that Leo Rosen of SIS had chosen when building a "duplicate" (or Purple analog machine) in Washington in 1939 and 1940. The "stepping switch" was a uniselector - a standard element used in large quantities in automatic telephone exchanges in countries like the United States, Canada, the UK and Japan, which had extensive dial-telephone systems.
Apparently, all other Purple machines at Japanese embassies and consulates around the world (e.g. in Axis countries, Washington, London, Moscow, and in neutral countries) and in Japan itself, were destroyed and ground into particles
The Purple machine itself was first used by Japan in June 1938, but U.S. and British cryptanalysts had broken some of its messages well before the attack on Pearl Harbor. U.S. cryptanalysts decrypted and translated Japan's 14-part message to its Washington Embassy (ominously) breaking off negotiations with the United States at 1 p.m. Washington time on 7 December 1941, before the Japanese Embassy in Washington had done so. Decryption and typing difficulties at the Embassy, coupled with ignorance of the importance of it being on time, were major reasons the "Nomura note" was delivered late.

Other factors

During World War II, the Japanese embassy in Nazi Germany was kept well-informed on German military affairs. This information was reported to Tokyo in Purple-enciphered radio messages. These reports included, for example, details of the Atlantic Wall fortifications along the coasts of France and Belgium. Since these messages were being read by the Allies, this provided valuable intelligence about German military preparations against the forthcoming invasion of Western Europe.
The decrypted Purple traffic, and Japanese messages generally, was the subject of acrimonious hearings in Congress post-World War II in connection with an attempt to decide who, if anyone, had allowed the attack at Pearl Harbor to happen and who therefore should be blamed. It was during those hearings that the Japanese learned, for the first time, that the Purple cipher machine had indeed been broken.
The Russians also succeeded in breaking into the PURPLE system in late 1941, and traffic indicating that Japan was only going to attack the US and UK allowed Stalin to move considerable forces from the Far East to Moscow just in time to help stop the final German push to Moscow.

Further reading






