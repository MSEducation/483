[[Fubini's theorem]]

CATEGORIES: Theorems in measure theory, Theorems in calculus, Articles containing proofs

In mathematical analysis Fubini's theorem, introduced by , is a result which gives conditions under which it is possible to compute a double integral using iterated integrals.
As a consequence it allows the order of integration to be changed in iterated integrals.
Fubini's theorem implies that the two repeated integrals of a function of two variables are equal if the function is integrable. Tonelli's theorem introduced by  is similar but applies to functions that are non-negative rather than integrable.

History

The special case of Fubini's theorem for continuous functions on a product of closed bounded subsets of real vector spaces was known to Euler in the 18th century.  extended this to bounded measurable functions on a product of intervals. In 1906 Levi conjectured that the theorem could be extended to functions that were integrable rather than bounded, and this was proved by Fubini in 1907.

Product measures

If X and Y are measure spaces with measures, there are several natural ways to define a product measure on their product. 
The product X×Y of measure spaces (in the sense of category theory) has as its measurable sets the σ-algebra generated by the products A×B of measurable subsets of X and Y. 
A measure μ on X×Y is called a product measure if μ(A×B)=μ(A)μ(B) for measurable subsets A and B. In general there may be many different product measures on X×Y. Fubini's theorem and Tonelli's theorem both need technical conditions to avoid this complication; the most common way is to assume all measure spaces are σ-finite, in which case there is a unique  product measure on X×Y. There is always a unique maximal product measure on X×Y, where the measure of a measurable set is the inf of the measures of sets containing it that are countable unions of products of measurable sets.  The maximal product measure can be constructed by applying Caratheodory's extension theorem to the additive function μ such that μ(A×B)=μ(A)μ(B) on the ring of sets generated by products of measurable sets.
The product of two complete measure spaces is not usually complete. For example, the product of the Lebesgue measure on the unit interval I with itself is not the Lebesgue measure on the square I×I. There is a variation of Fubini's theorem for complete measures, which uses the completion of the product of measures rather than the uncompleted product.

Fubini's theorem for integrable functions

Suppose X and Y are measure spaces, and suppose that X × Y is given the maximal product measure (which is the only product measure if X and Y are σ-finite). Fubini's theorem states that if f(x,y) is X × Y integrable, meaning that it is measurable and
is finite, then
If the above integral of the absolute value is not finite, then the two iterated integrals may actually have different values.  See below for an illustration of this possibility.
Fubini's theorem is often stated with the assumption that X and Y are σ-finite, in which case it is not necessary to assume that the product measure is maximal because this is the only product measure. 
If the spaces are not σ-finite there may be other product measures for which Fubini's theorem fails. For example, there is a product measure and a non-negative measurable function f for which the double integral of |f| is zero but the two iterated integrals have different values; see the section on counterexamples below for an example of this. There are some rather technical generalizations of Fubini's theorem to some non-maximal product measures; see . Tonelli's theorem and the Fubini–Tonelli theorem can fail on non σ-finite spaces even for the maximal product measure. In practice almost all measure spaces one wishes to use Fubini's theorem for are σ-finite.

Tonelli's theorem for non-negative functions

Tonelli's theorem (named after Leonida Tonelli) is a successor of Fubini's theorem. The conclusion of Tonelli's theorem is identical to that of Fubini's theorem, but the assumption that |f| has a finite integral is replaced by the assumption  that f is non-negative.  
Tonelli's theorem states that if (X, A, μ) and (Y, B, ν) are σ-finite measure spaces, while f from X×Y to 0,∞ is non-negative and measurable, then
Without the condition that the measure spaces are σ-finite it is possible for all three of these integrals to have different values. 
Some authors give generalizations of Tonelli's theorem to some measure spaces that are not σ-finite but these generalizations often add conditions that immediately reduce the problem to the σ-finite case.  For example, one could take the σ-algebra on A×B to be that generated by the product of subsets of finite measure, rather than that generated by all products of measurable subsets,though this has the undesirable consequence that the projections from the product to its factors A and B  are not measurable. Another way is to add the condition that the support of f is contained in a countable union of products of sets of finite measure.  gives some rather technical extensions of Tonelli's theorem to some non σ-finite spaces. None of these generalizations have found any significant applications outside abstract measure theory, largely because almost all measure spaces of practical interest are σ-finite.

The Fubini–Tonelli theorem

Combining Fubini's theorem with Tonelli's theorem gives
the Fubini–Tonelli theorem (often just called Fubini's theorem) which states that if X and Y are σ-finite measure spaces, and if f is a measurable function such that any one of the three integrals
is finite
then
The absolute value of f in the conditions above can be replaced by either the positive or the negative part of f; these forms include Tonelli's theorem as a special case as the negative part of a non-negative function is zero and so has finite integral. Informally all these conditions say that the double integral of f is well defined, though possibly infinite. 
The advantage of the Fubini–Tonelli over Fubini's theorem is that the repeated integrals of the absolute value of |f| may be easier to study than the double integral. As in Fubini's theorem, the single integrals may fail to be defined on a measure 0 set.

Fubini's theorem for complete measures

The versions of Fubini's and Tonelli's theorems above have the embarrassing problem that they do not even apply to integration on the product of the real line R with itself with Lebesgue measure.  The problem is that Lebesgue measure on R×R is not the product of Lebesgue measure on R with itself, but rather the completion of this: a product of two complete measure spaces X and Y is not in general complete.  For this reason one sometimes uses versions of Fubini's theorem for complete measures: roughly speaking one just replaces all measures by their completions.  The various versions of Fubini's theorem are similar to the versions above, with the following minor differences:

Proofs

Proofs of the Fubini and Tonelli theorems are necessarily somewhat technical, as they have to use a hypothesis related to σ-finiteness. Most proofs involve building up to the full theorems by proving them for increasingly complicated functions as follows.

Counterexamples

The following examples show how Fubini's theorem and Tonelli's theorem can fail if any of their hypotheses are omitted.

Failure of Tonelli's theorem for non σ-finite spaces

Suppose that X is the unit interval with the Lebesgue measurable sets and Lebesgue measure, and Y is the unit interval with all subsets measurable and the counting measure, so that Y is not σ-finite. If f is the characteristic function of the diagonal of X×Y, then integrating f along X gives the 0 function on Y, but integrating f along Y gives the function 1 on X. So the two iterated integrals are different. This shows that Tonelli's theorem can fail for spaces that are not σ-finite no matter what product measure is chosen. The measures are both decomposable, showing that Tonelli's theorem fails for decomposable measures (which are slightly more general than σ-finite measures).

Failure of Fubini's theorem for non-maximal product measures

Fubini's theorem holds for spaces even if they are not assumed to be σ-finite provided one uses the maximal product measure.
In the example above, for the maximal product measure, the diagonal has infinite measure so the double integral of |f| is infinite, and Fubini's theorem holds vacuously.
However, if we give X×Y the product measure such that the measure of a set is the sum of the Lebesgue measures of its horizontal sections, then the double integral of |f| is zero, but the two iterated integrals still have different values. This gives an example of a product measure where Fubini's theorem fails. 
This gives an example of two different product measures on the same product of two measure spaces. For products of two σ-finite measure spaces, there is only one product measure.

Failure of Tonelli's theorem for non-measurable functions

Suppose that X is the first uncountable ordinal, with the finite measure where the measurable sets are either countable (with measure 0) or the sets of countable complement (with measure 1). The (non-measurable) subset E of X×X given by pairs (x,y) with x
Failure of Fubini's theorem for non-measurable functions

A variation of the example above shows that Fubini's theorem can fail for non-measurable functions even if |f| is integrable and both repeated integrals are well defined: if we take f to be 1 on E and –1 on the complement of E, then |f| is integrable on the product with integral 1, and both repeated integrals are well defined, but have different values 1 and –1.
Assuming the continuum hypothesis, one can identify X with the unit interval I, so there is a bounded non-negative function on I×I  whose two iterated integrals (using Lebesgue measure) are both defined but unequal. This example was found by Sierpinski.
The stronger versions of Fubini's theorem on a product of two unit intervals with Lebesgue measure, where the function is no longer assumed to be measurable but merely that the two iterated integrals are well defined and exist, are independent of the standard Zermelo–Fraenkel axioms of set theory.  The continuum hypothesis and Martin's axiom both imply that there exists a function on the unit square whose iterated integrals are not equal, while  showed that it is consistent with ZFC that a strong Fubini-type theorem for 0, 1 does hold, and whenever the two iterated integrals exist they are equal.  See List of statements undecidable in ZFC.

Failure of Fubini's theorem for non-integrable functions

Fubini's theorem tells us that (for measurable functions on a product of σ-finite measure spaces) if the integral of the absolute value is finite, then the order of integration does not matter; if we integrate first with respect to x and then with respect to y, we get the same result as if we integrate first with respect to y and then with respect to x.  The assumption that the integral of the absolute value is finite is "Lebesgue integrability", and without it the two repeated integrals can have different values.
A simple example to show that the repeated integrals can be different in general is to take the two measure spaces to be the positive integers, and to take the function f(x,y) to be 1 if x=y, –1 if x=y+1, and 0 otherwise. Then the two repeated integrals have different values 0 and 1. 
Another example is as follows for the function
The iterated integrals
and
have different values. The corresponding double integral
does not converge absolutely (in other words the integral of the absolute value is not finite):

Kuratowski-Ulam theorem

The Kuratowski-Ulam theorem, named after Polish mathematicians Kazimierz Kuratowski and Stanislaw Ulam, called also Fubini theorem for category, is a similar result for arbitrary second countable Baire spaces.
Even if A does not have the Baire property, 2. follows from 1.S. Srivastava A course on Borel sets. Springer, 1998, p. 112.
Note that the theorem still holds (perhaps vacuously) for X - arbitrary Hausdorff space and Y - Hausdorff with countable π-base.
The theorem is analogous to regular Fubini theorem for the case where the considered function is a characteristic function of a set in a product space, with usual correspondences – meagre set with set of measure zero, comeagre set with one of full measure, a set with Baire property with a measurable set.





|title=Real analysis|series=Birkhäuser Advanced Texts: Basler Lehrbücher|publisher= Birkhäuser Boston, Inc.|place= Boston, MA|year= 2002|ISBN= 0-8176-4231-5}} 
|title=Measure theory|volume= 2 
|publisher=Torres Fremlin|place= Colchester|year=2003 |ISBN=0-9538129-2-8 }}




