[[Rule of succession]]

CATEGORIES: Probability assessment, Inductive reasoning

In probability theory, the rule of succession is a formula introduced in the 18th century by Pierre-Simon Laplace in the course of treating the sunrise problem. Essai philosophique sur les probabilités. Paris: Courcier.
The formula is still used, particularly to estimate underlying probabilities when there are few observations, or for events that have not been observed to occur at all in (finite) sample data.  Assigning events a zero probability contravenes Cromwell's rule, which can never be strictly justified in physical situations, albeit sometimes must be assumed in practice.

Statement of the rule of succession

If we repeat an experiment that we know can result in a success or failure, n times independently, and get s successes, then what is the probability that the next repetition will succeed?
More abstractly: If X1, ..., Xn+1 are conditionally independent random variables that each can assume the value 0 or 1, then, if we know nothing more about them,

Interpretation

Since we have the prior knowledge that we are looking at an experiment for which both success and failure are possible, our estimate is as if we had observed one success and one failure for sure before we even started the experiments.  In a sense we made n + 2 observations (known as pseudocounts) with s+1 successes. Beware: although this may seem the simplest and most reasonable assumption, which also happens to be true, so is a useful mnemonic, it still requires a proof! Indeed, assuming a pseudocount of one per possibility is one way to generalise the binary result, but has unexpected consequences — see Generalization to any number of possibilities, below.
Nevertheless, if we had not known from the start that both success and failure are possible, then we would have had to assign

Historical application to the sunrise problem

Laplace used the rule of succession to calculate the probability that the sun will rise tomorrow, given that it has risen every day for the past 5000 years.  One obtains a very large factor of approximately 5000 × 365.25, which gives odds of 1826251:1 in favour of the sun rising tomorrow.
However, as the mathematical details below show, the basic assumption for using the rule of succession would be that we have no prior knowledge about the question whether the sun will or will not rise tomorrow, except that it can do either.  This is not the case for sunrises.
Laplace knew this well, and himself wrote to conclude the sunrise example: "But this number is far greater for him who, seeing in the totality of phenomena the principle regulating the days and seasons, realizes that nothing at the present moment can arrest the course of it."
In the 1940es, Rudolf Carnap investigated a probability-based theory of inductive reasoning, and developed measures of degree of confirmation, which he considered as alternatives to Laplace's rule of succession.; here: p.145 See also New riddle of induction#Carnap.

Mathematical details

The proportion p is assigned a uniform distribution to describe the uncertainty about its true value. (Note: This proportion is not random, but uncertain.  We assign a probability distribution to p to express our uncertainty, not to attribute randomness to p.  But this amounts, mathematically, to the same thing as treating p as if it were random).
Let Xi be 1 if we observe a "success" on the ith trial, otherwise 0, with probability p of success on each trial.  Thus each X is 0 or 1; each X has a Bernoulli distribution.  Suppose these Xs are conditionally independent given p.
where s = x1 + ... + xn is the number of "successes" and n is of course the number of trials, and then normalizes, to get the "posterior" (i.e., conditional on the data) probability distribution of p.  (We are using capital X to denote a random variable and lower-case x either as the dummy in the definition of a function or as the data actually observed.)
The prior probability density function that expresses total ignorance of p except for the certain knowledge that it is neither 1 nor 0 (i.e., that we know that the experiment can in fact succeed or fail) is equal to 1 for 0 (see beta function for more on integrals of this form).
The posterior probability density function is therefore
This is a beta distribution with expected value
Since the conditional probability for success in the next experiment, given the value of p, is just p, the law of total probability tell us that the probability of success in the next experiment is just the expected value of p.  Since all of this is conditional on the observed data Xi for i = 1, ..., n, we have
The same calculation can be performed with the prior that expresses total ignorance of p, including ignorance with regards to the question whether the experiment can succeed, or can fail.  This prior, except for a normalizing constant, is 1/(p(1 − p)) for 0 ≤ p ≤ 1 and 0 otherwise.stats.uk/priors/noninformative/Smith.pdf  If the calculation above is repeated with this prior, we get
Thus, with the prior specifying total ignorance, the probability of success is governed by the observed frequency of success.  However, the posterior distribution that led to this result is the Beta(s,n − s) distribution, which is not proper when s = n or s = 0 (i.e. the normalisation constant is infinite when s = 0 or s = n).  This means that we cannot use this form of the posterior distribution to calculate the probability of the next observation succeeding when s = 0 or s = n.  This puts the information contained in the rule of succession in greater light: it can be thought of as expressing the prior assumption that if sampling was continued indefinitely, we would eventually observe at least one success, and at least one failure in the sample.  The prior expressing total ignorance does not assume this knowledge.
And it can be seen that, if s = n or s = 0, then one of the factorials in the numerator cancels exactly with one in the denominator.  Taking the s = 0 case, we have:
Adding in the normalising constant, which is always finite  (because there is no singularities in the range of the posterior, and there are a finite number of terms) gives:
An approximate analytical expression for large N is given by first making the approximation to the product term:
and then replacing the summation in the numerator with an integral
The same procedure is followed for the denominator, but the process is a bit more tricky, as the integral is harder to evaluate
where ln is the natural logarithm plugging in these approximations into the expectation gives
where the base 10 logarithm has been used in the final answer for ease of calculation.  For instance if the population is of size Nk then probability of success on the next sample is given by:
So for example, if the population be on the order of tens of billions, so that k = 10, and we observe n = 10 results without success, then the expected proportion in the population is approximately 0.43%.  If the population is smaller, so that n = 10, k = 5 (tens of thousands), the expected proportion rises to approximately 0.86%, and so on.  Similarly, if the number of observations is smaller, so that n = 5, k = 10, the proportion rise to approximately 0.86% again.

Generalization to any number of possibilities

This section gives a heuristic derivation to that given in Probability Theory: The Logic of Science.T. (2003), Probability Theory: The Logic of Science, Cambridge, UK, Cambridge University Press.
The rule of succession has many different intuitive interpretations, and depending on which intuition one uses, the generalisation may be different.  Thus, the way to proceed from here is very carefully, and to re-derive the results from first principles, rather than to introduce an intuitively sensible generalisation.  The full derivation can be found in Jaynes' book, but it does admit an easier to understand alternative derivation, once the solution is known.  Another point to emphasise is that the prior state of knowledge described by the rule of succession is given as an enumeration of the possibilities, with the additional information that it is possible to observe each category. This can be equivalently stated as observing each category once prior to gathering the data.  To denote that this is the knowledge used, an Im is put as part of the conditions in the probability assignments.
The rule of succession comes from setting a binomial likelihood, and a uniform prior distribution.  Thus a straight forward generalisation is just the multivariate extensions of these two distributions: 1)Setting a uniform prior over the initial m categories, and 2) using the multinomial distribution as the likelihood function (which is the multivariate generalisation of the binomial distribution).  It can be shown that the uniform distribution is a special case of the Dirichlet distribution with all of its parameters equal to 1 (just as the uniform is Beta(1,1) in the binary case).  The Dirichlet distribution is the conjugate prior for the multinomial distribution, which means that the posterior distribution is also a Dirichlet distribution with different parameters.  Let pi denote the probability that category i will be observed, and let ni denote the number of times category i (i = 1, ..., m) actually was observed.  Then the joint posterior distribution of the probabilities p1, ..., pm is given by;
To get the generalised rule of succession, note that the probability of observing category i on the next observation, conditional on the pi is just pi, we simply require its expectation.  Letting Ai denote the event that the next observation is in category i (i = 1, ..., m), and let n = n1 + ... + nm be the total number of observations made.  The result, using the properties of the dirichlet distribution is:
This solution reduces to the probability that would be assigned using the principle of indifference before any observations made (i.e. n = 0), consistent with the original rule of succession.  It also contains the rule of succession as a special case, when m = 2, as a generalisation should.
Because the propositions or events Ai are mutually exclusive, it is possible to collapse the m categories into 2.  Simply add up the Ai probabilities that correspond to "success" to get the probability of success.  Supposing that this aggregates c categories as "success" and m-c categories as "failure".  Let s denote the sum of the relevant ni values that have been termed "success". The probability of "success" at the next trial is then:
which is different from the original rule of succession.  But note that the original rule of succession is based on I2, whereas the generalisation is based on Im.  This means that the information contained in Im is different from that contained in I2.  This indicates that mere knowledge of more than two outcomes we know are possible is relevant information when collapsing these categories down to just two.  This illustrates the subtlety in describing the prior information, and why it is important to specify which prior information one is using.

Further analysis

A good model is essential (i.e., a good compromise between accuracy and practicality). To paraphrase Laplace on the sunrise problem: Although we have a huge number of samples of the sun rising, there are far better models of the sun than assuming it has a certain probability of rising each day, e.g., simply having a half-life.
Given a good model, it is best to make as many observations as practicable, depending of the expected reliability of prior knowledge, cost of observations, time and resources available, and accuracy required.
One of the most difficult aspects of the rule of succession is not the mathematical formulas, but answering the question: When does the rule of succession apply? In the generalisation section, it was noted very explicitly by adding the prior information Im into the calculations.  Thus, when all that is known about a phenomenon is that there are m known possible outcomes prior to observing any data, only then does the rule of succession apply.  If the rule of succession is applied in problems where this does not accurately describe the prior state of knowledge, then it may give counter-intuitive results.  This is not because the rule of succession is defective, but that it is effectively answering a different question, based on different prior information.
Prior probabilities are only worth spending significant effort estimating when likely to have significant effect. They may be important when there are few observations — especially when so few that there have been few, if any, observations of some possibilities – such as a rare animal, in a given region. Also important when there are many observations, where it is believed that the expectation should be heavily weighted towards the prior estimates, in spite of many observations to the contrary, such as for a roulette wheel in a well-respected casino. In the latter case, at least some of the pseudocounts may need to be very large. They are not always small, and thereby soon outweighed by actual observations, as is often assumed. However, although a last resort, for everyday purposes, prior knowledge is usually vital. So most decisions must be subjective to some extent (dependent upon the analyst and analysis used).






